import{r as c,f as k,j as e,L as g,a as _}from"./index-K0TI1Cn5.js";import{A as N}from"./Layout-MqCQlSlI.js";import{B as x,R as m,C as d,a}from"./Row-DpO6zsT4.js";import{P as f}from"./ProgressBar-Dzhpx0Dl.js";import{B as h}from"./NavBar-BemxVd0Z.js";import{T}from"./Table-fYcqLACk.js";import"./ElementChildren-DHcghUFE.js";function L(){const[o,v]=c.useState(null),[w,b]=c.useState(!0),[s,u]=c.useState("light"),[$,B]=c.useState("all");c.useEffect(()=>{const t=document.documentElement.getAttribute("data-theme")||"light";u(t);const n=new MutationObserver(()=>{const j=document.documentElement.getAttribute("data-theme")||"light";u(j)});return n.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>n.disconnect()},[]);const p=async()=>{try{b(!0);const t=await _.get("/tasks/tasks/admin_dashboard/");v(t.data)}catch(t){console.error("Erreur lors du chargement du dashboard",t)}finally{b(!1)}};c.useEffect(()=>{k.replace(),p()},[]),c.useEffect(()=>{k.replace()},[o]);const l=t=>t.total_tasks?Math.round(t.completed_tasks/t.total_tasks*100):0;if(w)return e.jsx(N,{children:e.jsxs("div",{className:"text-center py-5",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Chargement..."})}),e.jsx("p",{className:"mt-2",children:"Chargement du dashboard..."})]})});if(!o)return e.jsx(N,{children:e.jsxs("div",{className:"text-center py-5",children:[e.jsx("i",{"data-feather":"alert-triangle",className:"text-warning mb-3",style:{width:"48px",height:"48px"}}),e.jsx("h5",{children:"Erreur lors du chargement des données"}),e.jsx(x,{variant:"primary",onClick:p,className:"mt-3",children:"Réessayer"})]})});const{overview:r,users:i}=o;return e.jsx(N,{children:e.jsxs("div",{className:"container-fluid py-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`h3 mb-1 ${s==="dark"?"text-light":"text-dark"}`,children:"Dashboard des Tâches et Projets"}),e.jsx("p",{className:`mb-0 ${s==="dark"?"text-light":"text-muted"}`,children:"Vue d'ensemble de tous les projets et tâches par utilisateur"})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(x,{variant:"primary",as:g,to:"/admin/tasks",children:[e.jsx("i",{"data-feather":"list",className:"me-2",style:{width:"16px",height:"16px"}}),"Voir toutes les tâches"]}),e.jsxs(x,{variant:"success",as:g,to:"/admin/projects",children:[e.jsx("i",{"data-feather":"folder",className:"me-2",style:{width:"16px",height:"16px"}}),"Voir tous les projets"]})]})]}),e.jsxs(m,{className:"mb-4",children:[e.jsx(d,{md:2,children:e.jsx(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsx(a.Body,{className:"text-center",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`mb-0 ${s==="dark"?"text-light":"text-dark"}`,children:r.total_tasks}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Total Tâches"})]}),e.jsx("div",{className:"text-primary",children:e.jsx("i",{"data-feather":"check-square",style:{width:"24px",height:"24px"}})})]})})})}),e.jsx(d,{md:2,children:e.jsx(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsx(a.Body,{className:"text-center",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-0 text-success",children:r.completed_tasks}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Terminées"})]}),e.jsx("div",{className:"text-success",children:e.jsx("i",{"data-feather":"check-circle",style:{width:"24px",height:"24px"}})})]})})})}),e.jsx(d,{md:2,children:e.jsx(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsx(a.Body,{className:"text-center",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-0 text-warning",children:r.pending_tasks}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"En Attente"})]}),e.jsx("div",{className:"text-warning",children:e.jsx("i",{"data-feather":"clock",style:{width:"24px",height:"24px"}})})]})})})}),e.jsx(d,{md:2,children:e.jsx(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsx(a.Body,{className:"text-center",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-0 text-info",children:r.total_users}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Utilisateurs"})]}),e.jsx("div",{className:"text-info",children:e.jsx("i",{"data-feather":"users",style:{width:"24px",height:"24px"}})})]})})})}),e.jsx(d,{md:2,children:e.jsx(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsx(a.Body,{className:"text-center",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-0 text-purple",children:r.total_projects}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Projets"})]}),e.jsx("div",{className:"text-purple",children:e.jsx("i",{"data-feather":"folder",style:{width:"24px",height:"24px"}})})]})})})}),e.jsx(d,{md:2,children:e.jsx(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsx(a.Body,{className:"text-center",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-0 text-orange",children:r.active_projects}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Projets Actifs"})]}),e.jsx("div",{className:"text-orange",children:e.jsx("i",{"data-feather":"activity",style:{width:"24px",height:"24px"}})})]})})})})]}),e.jsx(m,{className:"mb-4",children:e.jsx(d,{md:12,children:e.jsxs(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:`border-0 ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"bar-chart",className:"me-2",style:{width:"20px",height:"20px"}}),"Taux d'Achèvement Global"]})}),e.jsxs(a.Body,{children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:"flex-grow-1 me-3",children:e.jsx(f,{now:r.total_tasks?Math.round(r.completed_tasks/r.total_tasks*100):0,variant:"success",style:{height:"12px"}})}),e.jsx("div",{className:"text-end",children:e.jsxs("strong",{className:s==="dark"?"text-light":"text-dark",children:[r.total_tasks?Math.round(r.completed_tasks/r.total_tasks*100):0,"%"]})})]}),e.jsxs("div",{className:"row text-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"border-end border-secondary",children:[e.jsx("div",{className:`h4 mb-1 ${s==="dark"?"text-light":"text-dark"}`,children:r.completed_tasks}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Terminées"})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"border-end border-secondary",children:[e.jsx("div",{className:`h4 mb-1 ${s==="dark"?"text-light":"text-dark"}`,children:r.pending_tasks}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"En Cours"})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"border-end border-secondary",children:[e.jsx("div",{className:`h4 mb-1 ${s==="dark"?"text-light":"text-dark"}`,children:r.total_projects}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Projets"})]})}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("div",{className:`h4 mb-1 ${s==="dark"?"text-light":"text-dark"}`,children:r.total_tasks}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Total Tâches"})]})]})]})]})})}),e.jsx(m,{children:e.jsx(d,{md:12,children:e.jsxs(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:`border-0 ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"users",className:"me-2",style:{width:"20px",height:"20px"}}),"Tâches par Utilisateur"]}),e.jsxs(h,{bg:"primary",className:"fs-6",children:[i.length," Utilisateurs"]})]})}),e.jsxs(a.Body,{children:[e.jsx("div",{className:"table-responsive",children:e.jsxs(T,{hover:!0,className:`align-middle ${s==="dark"?"table-dark":""}`,children:[e.jsx("thead",{className:"table-primary",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Utilisateur"}),e.jsx("th",{className:"text-center",children:"Total Tâches"}),e.jsx("th",{className:"text-center",children:"Terminées"}),e.jsx("th",{className:"text-center",children:"En Attente"}),e.jsx("th",{className:"text-center",children:"Taux d'Achèvement"}),e.jsx("th",{className:"text-center",children:"Performance"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:i.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle p-2 me-3",children:e.jsx("i",{"data-feather":"user",className:"text-primary",style:{width:"16px",height:"16px"}})}),e.jsxs("div",{children:[e.jsx("div",{className:`fw-bold ${s==="dark"?"text-light":"text-dark"}`,children:t.username}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:t.email})]})]})}),e.jsx("td",{className:"text-center",children:e.jsx(h,{bg:"primary",className:"fs-6",children:t.total_tasks||0})}),e.jsx("td",{className:"text-center",children:e.jsx(h,{bg:"success",className:"fs-6",children:t.completed_tasks||0})}),e.jsx("td",{className:"text-center",children:e.jsx(h,{bg:"warning",className:"fs-6",children:t.pending_tasks||0})}),e.jsx("td",{className:"text-center",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("div",{className:"flex-grow-1 me-2",style:{maxWidth:"100px"},children:e.jsx(f,{now:l(t),variant:l(t)>=80?"success":l(t)>=50?"warning":"danger",style:{height:"8px"}})}),e.jsxs("small",{className:s==="dark"?"text-light":"text-dark",children:[l(t),"%"]})]})}),e.jsx("td",{className:"text-center",children:e.jsx(h,{bg:l(t)>=80?"success":l(t)>=50?"warning":"danger",children:l(t)>=80?"Excellente":l(t)>=50?"Moyenne":"Faible"})}),e.jsx("td",{className:"text-center",children:e.jsx(x,{size:"sm",variant:"outline-primary",as:g,to:`/admin/users/${t.id}`,title:"Voir les tâches de cet utilisateur",children:e.jsx("i",{"data-feather":"eye",style:{width:"14px",height:"14px"}})})})]},t.id))})]})}),i.length===0&&e.jsxs("div",{className:"text-center py-5",children:[e.jsx("i",{"data-feather":"users",className:"mb-3",style:{width:"48px",height:"48px",opacity:.5}}),e.jsx("h6",{className:s==="dark"?"text-light":"text-dark",children:"Aucun utilisateur trouvé"}),e.jsx("p",{className:s==="dark"?"text-light":"text-muted",children:"Aucun utilisateur n'a encore créé de tâches."})]})]})]})})}),e.jsxs(m,{className:"mt-4",children:[e.jsx(d,{md:4,children:e.jsx(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs(a.Body,{className:"text-center",children:[e.jsx("i",{"data-feather":"award",className:"text-warning mb-3",style:{width:"32px",height:"32px"}}),e.jsx("h5",{className:s==="dark"?"text-light":"text-dark",children:"Meilleur Performeur"}),i.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fw-bold text-success mb-1",children:i.reduce((t,n)=>{const j=l(n),y=l(t);return j>y?n:t},i[0]).username}),e.jsxs("small",{className:s==="dark"?"text-light":"text-muted",children:[Math.max(...i.map(t=>l(t))),"% de taux d'achèvement"]})]}):e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Aucune donnée disponible"})]})})}),e.jsx(d,{md:4,children:e.jsx(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs(a.Body,{className:"text-center",children:[e.jsx("i",{"data-feather":"trending-up",className:"text-success mb-3",style:{width:"32px",height:"32px"}}),e.jsx("h5",{className:s==="dark"?"text-light":"text-dark",children:"Tâches Créées"}),e.jsx("div",{className:"fw-bold text-primary mb-1",children:r.total_tasks}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Total des tâches créées"})]})})}),e.jsx(d,{md:4,children:e.jsx(a,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs(a.Body,{className:"text-center",children:[e.jsx("i",{"data-feather":"target",className:"text-info mb-3",style:{width:"32px",height:"32px"}}),e.jsx("h5",{className:s==="dark"?"text-light":"text-dark",children:"Objectif Global"}),e.jsxs("div",{className:"fw-bold text-info mb-1",children:[r.total_tasks?Math.round(r.completed_tasks/r.total_tasks*100):0,"%"]}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Taux d'achèvement global"})]})})})]})]})})}export{L as default};
