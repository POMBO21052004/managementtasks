import{r as n,u as J,f as Z,j as e,L as S,a as F}from"./index-hRRtG8yy.js";import{C as K}from"./Container-BYekCvJV.js";import{R as P,C as f,a as y,B as h}from"./Row-bX7h-1jy.js";import{A as E}from"./Alert-CoKbwLKe.js";import{F as a}from"./Form-Dsmz1YOZ.js";import{P as Q}from"./ProgressBar-Dqb3uvNn.js";import{S as A}from"./Spinner-CLl_Ort6.js";import"./ElementChildren-NDIL728O.js";const re=()=>{const[x,_]=n.useState(1),[l,I]=n.useState({username:"",email:"",password:"",password_confirmation:"",otp_code:""}),[w,m]=n.useState(null),[r,p]=n.useState({}),[u,j]=n.useState(!1),[o,c]=n.useState(null),[N,L]=n.useState(null),[v,R]=n.useState(!1),[k,z]=n.useState(!1),[b,B]=n.useState(0),[C,M]=n.useState(!1),V=J(),[t,$]=n.useState(localStorage.getItem("theme")||"light");n.useEffect(()=>{const s=document.documentElement.getAttribute("data-theme")||"light";$(s);const i=new MutationObserver(()=>{const d=document.documentElement.getAttribute("data-theme")||"light";$(d)});return i.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>i.disconnect()},[]),n.useEffect(()=>{Z.replace()},[t,w,u,N,x]);const q=s=>{let i=0;return s.length>=8&&(i+=25),/[a-z]/.test(s)&&(i+=25),/[A-Z]/.test(s)&&(i+=25),/[0-9]/.test(s)&&(i+=25),i},T=s=>s<25?"danger":s<50?"warning":s<75?"info":"success",O=s=>s<25?"Très faible":s<50?"Faible":s<75?"Moyen":"Fort",g=s=>{const{name:i,value:d}=s.target;I({...l,[i]:d}),p({...r,[i]:null}),m(null),i==="password"&&B(q(d))},G=async s=>{if(s.preventDefault(),m(null),p({}),!C){m("Vous devez accepter les conditions d'utilisation pour continuer");return}j(!0);try{const i=await F.post("/register",{username:l.username,email:l.email,password:l.password,password_confirmation:l.password_confirmation});_(2)}catch(i){const d=i.response;d?.status===422&&d.data?.errors?p(d.data.errors):m(d?.data?.message||"Une erreur s'est produite lors de l'inscription")}finally{j(!1)}},D=async s=>{s.preventDefault(),m(null),p({}),j(!0);try{const i=await F.post("/verify-otp",{email:l.email,otp_code:l.otp_code});L("Inscription réussie ! Redirection vers la connexion..."),setTimeout(()=>V("/login"),3e3)}catch(i){const d=i.response;d?.status===422&&d.data?.errors?p(d.data.errors):m(d?.data?.message||"Code OTP invalide")}finally{j(!1)}},U=async()=>{try{await F.post("/resend-otp",{email:l.email}),m(null)}catch{m("Erreur lors de l'envoi du code OTP")}},H=()=>{const s=document.documentElement,i=s.getAttribute("data-theme")==="dark"?"light":"dark";s.setAttribute("data-theme",i),localStorage.setItem("theme",i),$(i)};return e.jsx("div",{className:`min-vh-100 d-flex align-items-center py-4 ${t==="dark"?"bg-dark":"bg-light"}`,style:{background:t==="dark"?"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)":"linear-gradient(135deg, #e3f2fd 0%, #f8f9fa 50%, #e8f5e8 100%)"},children:e.jsx(K,{children:e.jsx(P,{className:"justify-content-center",children:e.jsxs(f,{xl:6,lg:7,md:9,sm:11,children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("h1",{className:`h3 fw-bold mb-2 ${t==="dark"?"text-light":"text-dark"}`,children:[e.jsx("i",{"data-feather":"check-circle",className:"text-primary me-2",style:{width:"24px",height:"24px"}}),"Task Manager"]}),e.jsx("p",{className:`mb-0 ${t==="dark"?"text-light":"text-muted"}`,children:"Créez votre compte pour gérer vos tâches"}),e.jsx("div",{className:"d-flex justify-content-center align-items-center mt-2",children:e.jsxs("div",{className:"badge bg-info bg-opacity-10 text-info px-3 py-1 rounded-pill",children:[e.jsx("i",{"data-feather":"users",className:"me-1",style:{width:"14px",height:"14px"}}),"Rejoignez notre communauté"]})})]}),e.jsxs(y,{className:`shadow-lg border-0 overflow-hidden ${t==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx("div",{className:"bg-success",style:{height:"4px"}}),e.jsx(y.Header,{className:`text-center py-4 border-0 ${t==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:`mb-1 fw-bold ${t==="dark"?"text-light":"text-dark"}`,children:x===1?"Inscription":"Vérification OTP"}),e.jsx("small",{className:t==="dark"?"text-light":"text-muted",children:x===1?"Créez votre compte":"Finalisez votre inscription"})]}),e.jsx(h,{variant:t==="dark"?"outline-light":"outline-secondary",size:"sm",onClick:H,className:"rounded-circle p-2",style:{width:"40px",height:"40px"},children:e.jsx("i",{"data-feather":t==="dark"?"sun":"moon",style:{width:"16px",height:"16px"}})})]})}),e.jsxs(y.Body,{className:`p-4 ${t==="dark"?"bg-dark":"bg-white"}`,children:[w&&e.jsxs(E,{variant:"danger",className:"d-flex align-items-start mb-4",children:[e.jsx("i",{"data-feather":"alert-circle",className:"text-danger me-2 mt-1",style:{width:"18px",height:"18px"}}),e.jsxs("div",{children:[e.jsx("strong",{children:"Erreur"}),e.jsx("div",{className:"small mt-1",children:w})]})]}),N&&e.jsxs(E,{variant:"success",className:"d-flex align-items-start mb-4",children:[e.jsx("i",{"data-feather":"check-circle",className:"text-success me-2 mt-1",style:{width:"18px",height:"18px"}}),e.jsxs("div",{children:[e.jsx("strong",{children:"Inscription réussie !"}),e.jsx("div",{className:"small mt-1",children:N})]})]}),x===1&&e.jsxs(a,{onSubmit:G,className:"needs-validation",noValidate:!0,children:[e.jsxs(P,{className:"g-4",children:[e.jsx(f,{md:12,children:e.jsxs(a.Group,{children:[e.jsxs(a.Label,{className:`fw-semibold ${t==="dark"?"text-light":"text-dark"}`,children:[e.jsx("i",{"data-feather":"user",className:"me-2",style:{width:"16px",height:"16px"}}),"Nom d'utilisateur *"]}),e.jsxs("div",{className:"position-relative",children:[e.jsx(a.Control,{type:"text",name:"username",placeholder:"Votre nom d'utilisateur",value:l.username,onChange:g,onFocus:()=>c("username"),onBlur:()=>c(null),isInvalid:!!r.username,className:`py-3 ps-5 ${t==="dark"?"bg-dark text-light border-secondary":"bg-light"} ${o==="username"?"border-primary shadow-sm":""}`,required:!0}),e.jsx("div",{className:"position-absolute top-50 start-0 translate-middle-y ps-3",children:e.jsx("i",{"data-feather":"user",className:`${o==="username"?"text-primary":t==="dark"?"text-light":"text-muted"}`,style:{width:"18px",height:"18px"}})})]}),r.username&&e.jsxs(a.Control.Feedback,{type:"invalid",className:"d-block",children:[e.jsx("i",{"data-feather":"x-circle",className:"me-1",style:{width:"14px",height:"14px"}}),r.username]})]})}),e.jsx(f,{md:12,children:e.jsxs(a.Group,{children:[e.jsxs(a.Label,{className:`fw-semibold ${t==="dark"?"text-light":"text-dark"}`,children:[e.jsx("i",{"data-feather":"mail",className:"me-2",style:{width:"16px",height:"16px"}}),"Adresse email *"]}),e.jsxs("div",{className:"position-relative",children:[e.jsx(a.Control,{type:"email",name:"email",placeholder:"votre@email.com",value:l.email,onChange:g,onFocus:()=>c("email"),onBlur:()=>c(null),isInvalid:!!r.email,className:`py-3 ps-5 ${t==="dark"?"bg-dark text-light border-secondary":"bg-light"} ${o==="email"?"border-primary shadow-sm":""}`,required:!0}),e.jsx("div",{className:"position-absolute top-50 start-0 translate-middle-y ps-3",children:e.jsx("i",{"data-feather":"at-sign",className:`${o==="email"?"text-primary":t==="dark"?"text-light":"text-muted"}`,style:{width:"18px",height:"18px"}})})]}),r.email&&e.jsxs(a.Control.Feedback,{type:"invalid",className:"d-block",children:[e.jsx("i",{"data-feather":"x-circle",className:"me-1",style:{width:"14px",height:"14px"}}),r.email]})]})}),e.jsx(f,{md:6,children:e.jsxs(a.Group,{children:[e.jsxs(a.Label,{className:`fw-semibold ${t==="dark"?"text-light":"text-dark"}`,children:[e.jsx("i",{"data-feather":"lock",className:"me-2",style:{width:"16px",height:"16px"}}),"Mot de passe *"]}),e.jsxs("div",{className:"position-relative",children:[e.jsx(a.Control,{type:v?"text":"password",name:"password",placeholder:"••••••••",value:l.password,onChange:g,onFocus:()=>c("password"),onBlur:()=>c(null),isInvalid:!!r.password,className:`py-3 ps-5 pe-5 ${t==="dark"?"bg-dark text-light border-secondary":"bg-light"} ${o==="password"?"border-primary shadow-sm":""}`,required:!0}),e.jsx("div",{className:"position-absolute top-50 start-0 translate-middle-y ps-3",children:e.jsx("i",{"data-feather":"key",className:`${o==="password"?"text-primary":t==="dark"?"text-light":"text-muted"}`,style:{width:"18px",height:"18px"}})}),e.jsx(h,{variant:"link",className:"position-absolute top-50 end-0 translate-middle-y border-0 text-decoration-none p-0 pe-3",onClick:()=>R(!v),type:"button",children:e.jsx("i",{"data-feather":v?"eye-off":"eye",className:t==="dark"?"text-light":"text-muted",style:{width:"18px",height:"18px"}})})]}),l.password&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsx("small",{className:t==="dark"?"text-light":"text-muted",children:"Force du mot de passe:"}),e.jsx("small",{className:`text-${T(b)}`,children:O(b)})]}),e.jsx(Q,{now:b,variant:T(b),style:{height:"6px"}})]}),r.password&&e.jsxs(a.Control.Feedback,{type:"invalid",className:"d-block",children:[e.jsx("i",{"data-feather":"x-circle",className:"me-1",style:{width:"14px",height:"14px"}}),r.password]})]})}),e.jsx(f,{md:6,children:e.jsxs(a.Group,{children:[e.jsxs(a.Label,{className:`fw-semibold ${t==="dark"?"text-light":"text-dark"}`,children:[e.jsx("i",{"data-feather":"shield",className:"me-2",style:{width:"16px",height:"16px"}}),"Confirmer le mot de passe *"]}),e.jsxs("div",{className:"position-relative",children:[e.jsx(a.Control,{type:k?"text":"password",name:"password_confirmation",placeholder:"••••••••",value:l.password_confirmation,onChange:g,onFocus:()=>c("password_confirmation"),onBlur:()=>c(null),isInvalid:!!r.password_confirmation,className:`py-3 ps-5 pe-5 ${t==="dark"?"bg-dark text-light border-secondary":"bg-light"} ${o==="password_confirmation"?"border-primary shadow-sm":""}`,required:!0}),e.jsx("div",{className:"position-absolute top-50 start-0 translate-middle-y ps-3",children:e.jsx("i",{"data-feather":"check-circle",className:`${o==="password_confirmation"?"text-primary":t==="dark"?"text-light":"text-muted"}`,style:{width:"18px",height:"18px"}})}),e.jsx(h,{variant:"link",className:"position-absolute top-50 end-0 translate-middle-y border-0 text-decoration-none p-0 pe-3",onClick:()=>z(!k),type:"button",children:e.jsx("i",{"data-feather":k?"eye-off":"eye",className:t==="dark"?"text-light":"text-muted",style:{width:"18px",height:"18px"}})})]}),r.password_confirmation&&e.jsxs(a.Control.Feedback,{type:"invalid",className:"d-block",children:[e.jsx("i",{"data-feather":"x-circle",className:"me-1",style:{width:"14px",height:"14px"}}),r.password_confirmation]})]})})]}),e.jsx("div",{className:"mt-4 p-3 rounded-3 bg-info bg-opacity-10",children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{"data-feather":"info",className:"text-info me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("small",{className:"fw-semibold text-info",children:"Conseils pour un mot de passe sécurisé :"}),e.jsxs("ul",{className:`small mb-0 mt-1 ${t==="dark"?"text-light":"text-muted"}`,children:[e.jsx("li",{children:"Au moins 8 caractères"}),e.jsx("li",{children:"Majuscules et minuscules"}),e.jsx("li",{children:"Au moins un chiffre"})]})]})]})}),e.jsx("div",{className:"mt-4",children:e.jsx(a.Check,{type:"checkbox",id:"accept-terms",checked:C,onChange:s=>M(s.target.checked),label:e.jsxs("span",{className:t==="dark"?"text-light":"text-dark",children:["J'accepte les"," ",e.jsx(S,{to:"/conditions",className:"text-primary text-decoration-none fw-semibold",children:"conditions d'utilisation"})," ","et la"," ",e.jsx(S,{to:"/confidentialite",className:"text-primary text-decoration-none fw-semibold",children:"charte de vie privée"})]}),className:"user-select-none",required:!0})}),e.jsx(h,{type:"submit",variant:"success",disabled:u||!C,className:"w-100 py-3 fw-semibold text-white border-0 mt-4 position-relative",style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",boxShadow:"0 4px 15px rgba(40, 167, 69, 0.3)"},children:u?e.jsxs(e.Fragment,{children:[e.jsx(A,{animation:"border",size:"sm",className:"me-2"}),"Création du compte..."]}):e.jsx(e.Fragment,{children:"Créer mon compte"})})]}),x===2&&e.jsxs(a,{onSubmit:D,className:"needs-validation",noValidate:!0,children:[e.jsx("div",{className:"mb-4 p-3 rounded-3 bg-info bg-opacity-10",children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{"data-feather":"mail",className:"text-info me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("small",{className:"fw-semibold text-info",children:"Vérification en deux étapes"}),e.jsxs("div",{className:`small mt-1 ${t==="dark"?"text-light":"text-muted"}`,children:["Un code de vérification a été envoyé à ",e.jsx("strong",{children:l.email})]})]})]})}),e.jsxs(a.Group,{className:"mb-4",children:[e.jsxs(a.Label,{className:`fw-semibold ${t==="dark"?"text-light":"text-dark"}`,children:[e.jsx("i",{"data-feather":"shield",className:"me-2",style:{width:"16px",height:"16px"}}),"Code de vérification"]}),e.jsxs("div",{className:"position-relative",children:[e.jsx(a.Control,{type:"text",name:"otp_code",placeholder:"123456",value:l.otp_code,onChange:g,onFocus:()=>c("otp_code"),onBlur:()=>c(null),isInvalid:!!r.otp_code,className:`py-3 ps-5 ${t==="dark"?"bg-dark text-light border-secondary":"bg-light"} ${o==="otp_code"?"border-primary shadow-sm":""}`,required:!0,maxLength:6}),e.jsx("div",{className:"position-absolute top-50 start-0 translate-middle-y ps-3",children:e.jsx("i",{"data-feather":"key",className:`${o==="otp_code"?"text-primary":t==="dark"?"text-light":"text-muted"}`,style:{width:"18px",height:"18px"}})})]}),r.otp_code&&e.jsxs(a.Control.Feedback,{type:"invalid",className:"d-block",children:[e.jsx("i",{"data-feather":"x-circle",className:"me-1",style:{width:"14px",height:"14px"}}),r.otp_code]})]}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs(h,{variant:"link",onClick:U,className:"text-primary text-decoration-none",children:[e.jsx("i",{"data-feather":"refresh-cw",className:"me-1",style:{width:"14px",height:"14px"}}),"Renvoyer le code"]})}),e.jsx(h,{type:"submit",variant:"success",disabled:u,className:"w-100 py-3 fw-semibold text-white border-0 position-relative",style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",boxShadow:"0 4px 15px rgba(40, 167, 69, 0.3)"},children:u?e.jsxs(e.Fragment,{children:[e.jsx(A,{animation:"border",size:"sm",className:"me-2"}),"Vérification..."]}):e.jsx(e.Fragment,{children:"Finaliser l'inscription"})}),e.jsxs(h,{variant:"outline-secondary",onClick:()=>_(1),className:"w-100 mt-3 py-3",children:[e.jsx("i",{"data-feather":"arrow-left",className:"me-2",style:{width:"16px",height:"16px"}}),"Retour"]})]}),x===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center my-4",children:[e.jsx("hr",{className:t==="dark"?"border-secondary":""}),e.jsx("span",{className:`px-3 small ${t==="dark"?"bg-dark text-light":"bg-white text-muted"}`,children:"Déjà inscrit ?"})]}),e.jsx("div",{className:"text-center",children:e.jsxs(S,{to:"/login",className:"btn btn-outline-primary w-100 py-3 fw-semibold",children:[e.jsx("i",{"data-feather":"log-in",className:"me-2",style:{width:"18px",height:"18px"}}),"Se connecter"]})})]})]}),e.jsx(y.Footer,{className:`text-center py-3 border-0 ${t==="dark"?"bg-dark":"bg-light"}`,children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{"data-feather":"shield",className:"text-success me-2",style:{width:"16px",height:"16px"}}),e.jsx("small",{className:`fw-semibold ${t==="dark"?"text-light":"text-muted"}`,children:"Authentification sécurisée à deux facteurs"})]})})]})]})})})})};export{re as default};
