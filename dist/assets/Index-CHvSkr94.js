import{r as a,a as A,f as v,j as e,L as l}from"./index-K0TI1Cn5.js";import{A as C}from"./Layout-MqCQlSlI.js";import{B as r,a as c,R as S,C as x}from"./Row-DpO6zsT4.js";import{F as d}from"./Form-CAmGkuOD.js";import{T as E}from"./Table-fYcqLACk.js";import{B as u}from"./NavBar-BemxVd0Z.js";import"./ElementChildren-DHcghUFE.js";function D(){const[n,k]=a.useState([]),[j,p]=a.useState(!0),[s,g]=a.useState("light"),[h,f]=a.useState(""),[o,N]=a.useState("");a.useEffect(()=>{const t=document.documentElement.getAttribute("data-theme")||"light";g(t);const i=new MutationObserver(()=>{const $=document.documentElement.getAttribute("data-theme")||"light";g($)});return i.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>i.disconnect()},[]);const m=a.useCallback(async()=>{try{p(!0);const t={};h&&(t.search=h),o&&(t.status=o);const i=await A.get("/tasks/projects/",{params:t});k(i.data.results||i.data||[])}catch(t){console.error("Erreur lors du chargement des projets",t)}finally{p(!1)}},[h,o]);a.useEffect(()=>{v.replace(),m()},[m]),a.useEffect(()=>{v.replace()},[n]);const y=t=>({active:"success",completed:"primary",archived:"secondary",on_hold:"warning"})[t]||"secondary",w=t=>({active:"Actif",completed:"Terminé",archived:"Archivé",on_hold:"En pause"})[t]||t,b=t=>t?new Date(t).toLocaleDateString("fr-FR"):"Non définie";return e.jsx(C,{children:e.jsxs("div",{className:"container-fluid py-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`h3 mb-1 ${s==="dark"?"text-light":"text-dark"}`,children:"Gestion des Projets"}),e.jsx("p",{className:`mb-0 ${s==="dark"?"text-light":"text-muted"}`,children:"Administration de tous les projets"})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(r,{variant:"primary",as:l,to:"/admin/dashboard",children:[e.jsx("i",{"data-feather":"bar-chart",className:"me-2",style:{width:"16px",height:"16px"}}),"Dashboard"]}),e.jsxs(r,{variant:"success",as:l,to:"/admin/projects/create",children:[e.jsx("i",{"data-feather":"plus",className:"me-2",style:{width:"16px",height:"16px"}}),"Nouveau Projet"]})]})]}),e.jsx(c,{className:`border-0 shadow-sm mb-4 ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsx(c.Body,{children:e.jsxs(S,{className:"g-3",children:[e.jsxs(x,{md:6,children:[e.jsx(d.Label,{className:`small fw-bold ${s==="dark"?"text-light":"text-dark"}`,children:"Recherche"}),e.jsx(d.Control,{type:"text",placeholder:"Rechercher par titre ou description...",value:h,onChange:t=>f(t.target.value),className:s==="dark"?"bg-dark text-light border-secondary":""})]}),e.jsxs(x,{md:4,children:[e.jsx(d.Label,{className:`small fw-bold ${s==="dark"?"text-light":"text-dark"}`,children:"Statut"}),e.jsxs(d.Select,{value:o,onChange:t=>N(t.target.value),className:s==="dark"?"bg-dark text-light border-secondary":"",children:[e.jsx("option",{value:"",children:"Tous"}),e.jsx("option",{value:"active",children:"Actif"}),e.jsx("option",{value:"completed",children:"Terminé"}),e.jsx("option",{value:"on_hold",children:"En pause"}),e.jsx("option",{value:"archived",children:"Archivé"})]})]}),e.jsxs(x,{md:1,children:[e.jsx(d.Label,{className:`small fw-bold ${s==="dark"?"text-light":"text-dark"}`,children:" "}),e.jsx(r,{variant:"primary",className:"w-100",onClick:m,children:e.jsx("i",{"data-feather":"filter",className:"me-1",style:{width:"14px",height:"14px"}})})]}),e.jsxs(x,{md:1,children:[e.jsx(d.Label,{className:`small fw-bold ${s==="dark"?"text-light":"text-dark"}`,children:" "}),e.jsx(r,{variant:"outline-secondary",className:"w-100",onClick:()=>{f(""),N("")},children:e.jsx("i",{"data-feather":"refresh-cw",className:"me-1",style:{width:"14px",height:"14px"}})})]})]})})}),e.jsxs(c,{className:`border-0 shadow-sm ${s==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(c.Header,{className:`border-0 ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"folder",className:"me-2",style:{width:"20px",height:"20px"}}),"Liste des Projets (",n.length,")"]})})}),e.jsxs(c.Body,{children:[e.jsx("div",{className:"table-responsive",children:e.jsxs(E,{hover:!0,className:`align-middle ${s==="dark"?"table-dark":""}`,children:[e.jsx("thead",{className:"table-primary",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Projet"}),e.jsx("th",{className:"text-center",children:"Tâches"}),e.jsx("th",{className:"text-center",children:"Terminées"}),e.jsx("th",{className:"text-center",children:"Statut"}),e.jsx("th",{children:"Créé le"}),e.jsx("th",{children:"Dernière modification"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:n.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("div",{className:`fw-bold ${s==="dark"?"text-light":"text-dark"}`,title:t.title,children:t.title.length>15?`${t.title.substring(0,15)}...`:t.title}),t.description&&e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:t.description.length>70?`${t.description.substring(0,70)}...`:t.description})]})}),e.jsx("td",{className:"text-center",children:e.jsx(u,{bg:"primary",className:"fs-6",children:t.tasks_count||0})}),e.jsx("td",{className:"text-center",children:e.jsx(u,{bg:"success",className:"fs-6",children:t.completed_tasks_count||0})}),e.jsx("td",{className:"text-center",children:e.jsx(u,{bg:y(t.status),children:w(t.status)})}),e.jsx("td",{children:e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:b(t.created_at)})}),e.jsx("td",{children:e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:b(t.updated_at)})}),e.jsx("td",{className:"text-center",children:e.jsxs("div",{className:"d-flex gap-1 justify-content-center",children:[e.jsx(r,{size:"sm",variant:"outline-info",as:l,to:`/admin/projects/${t.id}`,title:"Voir les détails",children:e.jsx("i",{"data-feather":"eye",style:{width:"14px",height:"14px"}})}),e.jsx(r,{size:"sm",variant:"outline-warning",as:l,to:`/admin/projects/${t.id}/edit`,title:"Modifier",children:e.jsx("i",{"data-feather":"edit",style:{width:"14px",height:"14px"}})}),e.jsx(r,{size:"sm",variant:"outline-primary",as:l,to:`/admin/projects/${t.id}/tasks`,title:"Voir les tâches",children:e.jsx("i",{"data-feather":"list",style:{width:"14px",height:"14px"}})})]})})]},t.id))})]})}),n.length===0&&!j&&e.jsxs("div",{className:"text-center py-5",children:[e.jsx("i",{"data-feather":"folder",className:"mb-3",style:{width:"48px",height:"48px",opacity:.5}}),e.jsx("h6",{className:s==="dark"?"text-light":"text-dark",children:"Aucun projet trouvé"}),e.jsx("p",{className:s==="dark"?"text-light":"text-muted",children:"Aucun projet ne correspond à vos critères de recherche."}),e.jsxs(r,{variant:"success",as:l,to:"/admin/projects/create",children:[e.jsx("i",{"data-feather":"plus",className:"me-2",style:{width:"16px",height:"16px"}}),"Créer le premier projet"]})]}),j&&e.jsxs("div",{className:"text-center py-5",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Chargement..."})}),e.jsx("p",{className:"mt-2",children:"Chargement des projets..."})]})]})]})]})})}export{D as default};
