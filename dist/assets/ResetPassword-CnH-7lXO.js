import{c as U,u as q,r as i,f as G,j as e,L as P,a as H}from"./index-K0TI1Cn5.js";import{C as O}from"./Container-Jb0DCQyA.js";import{R as j,C as d,a as b,B as w}from"./Row-DpO6zsT4.js";import{A as L}from"./Alert-JqR1u8An.js";import{F as l}from"./Form-CAmGkuOD.js";import{P as Z}from"./ProgressBar-Dzhpx0Dl.js";import{S as J}from"./Spinner-Br6_VxcD.js";import"./ElementChildren-DHcghUFE.js";const ae=()=>{const S=U(),R=q(),N=new URLSearchParams(S.search).get("token"),o=new URLSearchParams(S.search).get("email"),[n,A]=i.useState({email:o||"",token:N||"",password:"",password_confirmation:""}),[m,h]=i.useState(null),[c,v]=i.useState({}),[y,C]=i.useState(!1),[x,_]=i.useState(null),[u,p]=i.useState(null),[k,z]=i.useState(!1),[$,T]=i.useState(!1),[g,M]=i.useState(0),[s,f]=i.useState(localStorage.getItem("theme")||"light");i.useEffect(()=>{(!N||!o)&&h("Lien de réinitialisation invalide. Veuillez demander un nouveau lien.")},[N,o]),i.useEffect(()=>{const t=document.documentElement.getAttribute("data-theme")||"light";f(t);const a=new MutationObserver(()=>{const r=document.documentElement.getAttribute("data-theme")||"light";f(r)});return a.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>a.disconnect()},[]),i.useEffect(()=>{G.replace()},[s,m,y,x]);const B=t=>{let a=0;return t.length>=8&&(a+=25),/[a-z]/.test(t)&&(a+=25),/[A-Z]/.test(t)&&(a+=25),/[0-9]/.test(t)&&(a+=25),a},F=t=>t<25?"danger":t<50?"warning":t<75?"info":"success",I=t=>t<25?"Très faible":t<50?"Faible":t<75?"Moyen":"Fort",E=t=>{const{name:a,value:r}=t.target;A({...n,[a]:r}),v({...c,[a]:null}),h(null),a==="password"&&M(B(r))},V=async t=>{t.preventDefault(),h(null),v({}),C(!0);try{const a=await H.post("/reset-password",n);_(a.data.message||"Mot de passe réinitialisé avec succès ! Redirection vers la connexion..."),setTimeout(()=>R("/login"),3e3)}catch(a){const r=a.response;r?.status===422&&r.data?.errors?v(r.data.errors):h(r?.data?.message||"Une erreur s'est produite lors de la réinitialisation")}finally{C(!1)}},D=()=>{const t=document.documentElement,a=t.getAttribute("data-theme")==="dark"?"light":"dark";t.setAttribute("data-theme",a),localStorage.setItem("theme",a),f(a)};return i.useEffect(()=>{const t=localStorage.getItem("theme");t&&(document.documentElement.setAttribute("data-theme",t),f(t))},[]),e.jsx("div",{className:`min-vh-100 d-flex align-items-center py-4 ${s==="dark"?"bg-dark":"bg-light"}`,style:{background:s==="dark"?"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)":"linear-gradient(135deg, #e3f2fd 0%, #f8f9fa 50%, #e8f5e8 100%)"},children:e.jsx(O,{children:e.jsx(j,{className:"justify-content-center",children:e.jsxs(d,{xl:6,lg:7,md:9,sm:11,children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("h1",{className:`h3 fw-bold mb-2 ${s==="dark"?"text-light":"text-dark"}`,children:[e.jsx("i",{"data-feather":"book-open",className:"text-primary me-2",style:{width:"24px",height:"24px"}}),"Nouveau mot de passe"]}),e.jsx("p",{className:`mb-0 ${s==="dark"?"text-light":"text-muted"}`,children:"Créez un nouveau mot de passe sécurisé pour votre compte"}),o&&e.jsx("div",{className:"d-flex justify-content-center align-items-center mt-2",children:e.jsxs("div",{className:"badge bg-success bg-opacity-10 text-success px-3 py-1 rounded-pill",children:[e.jsx("i",{"data-feather":"mail",className:"me-1",style:{width:"14px",height:"14px"}}),o]})})]}),e.jsxs(b,{className:`shadow-lg border-0 overflow-hidden ${s==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx("div",{className:"bg-success",style:{height:"4px"}}),e.jsx(b.Header,{className:`text-center py-4 border-0 ${s==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:`mb-1 fw-bold ${s==="dark"?"text-light":"text-dark"}`,children:"Réinitialisation du mot de passe"}),e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Définissez un nouveau mot de passe fort et sécurisé"})]}),e.jsx(w,{variant:s==="dark"?"outline-light":"outline-secondary",size:"sm",onClick:D,className:"rounded-circle p-2",style:{width:"40px",height:"40px"},children:e.jsx("i",{"data-feather":s==="dark"?"sun":"moon",style:{width:"16px",height:"16px"}})})]})}),e.jsxs(b.Body,{className:`p-4 ${s==="dark"?"bg-dark":"bg-white"}`,children:[m&&e.jsxs(L,{variant:"danger",className:"d-flex align-items-start mb-4",children:[e.jsx("i",{"data-feather":"alert-circle",className:"text-danger me-2 mt-1",style:{width:"18px",height:"18px"}}),e.jsxs("div",{children:[e.jsx("strong",{children:"Erreur de réinitialisation"}),e.jsx("div",{className:"small mt-1",children:m})]})]}),x&&e.jsxs(L,{variant:"success",className:"d-flex align-items-start mb-4",children:[e.jsx("i",{"data-feather":"check-circle",className:"text-success me-2 mt-1",style:{width:"18px",height:"18px"}}),e.jsxs("div",{children:[e.jsx("strong",{children:"Mot de passe réinitialisé !"}),e.jsx("div",{className:"small mt-1",children:x})]})]}),!x&&!m&&e.jsxs(l,{onSubmit:V,className:"needs-validation",noValidate:!0,children:[e.jsx("div",{className:"mb-4 p-3 rounded-3 bg-success bg-opacity-10",children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{"data-feather":"shield-check",className:"text-success me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("small",{className:"fw-semibold text-success",children:"Lien de réinitialisation valide"}),e.jsx("div",{className:`small mt-1 ${s==="dark"?"text-light":"text-muted"}`,children:"Vous pouvez maintenant définir un nouveau mot de passe sécurisé pour votre compte étudiant."})]})]})}),e.jsxs(j,{className:"g-4",children:[e.jsx(d,{md:12,children:e.jsxs(l.Group,{children:[e.jsxs(l.Label,{className:`fw-semibold ${s==="dark"?"text-light":"text-dark"}`,children:[e.jsx("i",{"data-feather":"lock",className:"me-2",style:{width:"16px",height:"16px"}}),"Nouveau mot de passe *"]}),e.jsxs("div",{className:"position-relative",children:[e.jsx(l.Control,{type:k?"text":"password",name:"password",placeholder:"••••••••",value:n.password,onChange:E,onFocus:()=>p("password"),onBlur:()=>p(null),isInvalid:!!c.password,className:`py-3 ps-5 pe-5 ${s==="dark"?"bg-dark text-light border-secondary":"bg-light"} ${u==="password"?"border-primary shadow-sm":""}`,required:!0}),e.jsx("div",{className:"position-absolute top-50 start-0 translate-middle-y ps-3",children:e.jsx("i",{"data-feather":"key",className:`${u==="password"?"text-primary":s==="dark"?"text-light":"text-muted"}`,style:{width:"18px",height:"18px"}})}),e.jsx(w,{variant:"link",className:"position-absolute top-50 end-0 translate-middle-y border-0 text-decoration-none p-0 pe-3",onClick:()=>z(!k),type:"button",children:e.jsx("i",{"data-feather":k?"eye-off":"eye",className:s==="dark"?"text-light":"text-muted",style:{width:"18px",height:"18px"}})})]}),n.password&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsx("small",{className:s==="dark"?"text-light":"text-muted",children:"Force du mot de passe:"}),e.jsx("small",{className:`text-${F(g)}`,children:I(g)})]}),e.jsx(Z,{now:g,variant:F(g),style:{height:"6px"}})]}),c.password&&e.jsxs(l.Control.Feedback,{type:"invalid",className:"d-block",children:[e.jsx("i",{"data-feather":"x-circle",className:"me-1",style:{width:"14px",height:"14px"}}),c.password]})]})}),e.jsx(d,{md:12,children:e.jsxs(l.Group,{children:[e.jsxs(l.Label,{className:`fw-semibold ${s==="dark"?"text-light":"text-dark"}`,children:[e.jsx("i",{"data-feather":"shield",className:"me-2",style:{width:"16px",height:"16px"}}),"Confirmer le nouveau mot de passe *"]}),e.jsxs("div",{className:"position-relative",children:[e.jsx(l.Control,{type:$?"text":"password",name:"password_confirmation",placeholder:"••••••••",value:n.password_confirmation,onChange:E,onFocus:()=>p("password_confirmation"),onBlur:()=>p(null),isInvalid:!!c.password_confirmation,className:`py-3 ps-5 pe-5 ${s==="dark"?"bg-dark text-light border-secondary":"bg-light"} ${u==="password_confirmation"?"border-primary shadow-sm":""}`,required:!0}),e.jsx("div",{className:"position-absolute top-50 start-0 translate-middle-y ps-3",children:e.jsx("i",{"data-feather":"check-circle",className:`${u==="password_confirmation"?"text-primary":s==="dark"?"text-light":"text-muted"}`,style:{width:"18px",height:"18px"}})}),e.jsx(w,{variant:"link",className:"position-absolute top-50 end-0 translate-middle-y border-0 text-decoration-none p-0 pe-3",onClick:()=>T(!$),type:"button",children:e.jsx("i",{"data-feather":$?"eye-off":"eye",className:s==="dark"?"text-light":"text-muted",style:{width:"18px",height:"18px"}})})]}),c.password_confirmation&&e.jsxs(l.Control.Feedback,{type:"invalid",className:"d-block",children:[e.jsx("i",{"data-feather":"x-circle",className:"me-1",style:{width:"14px",height:"14px"}}),c.password_confirmation]})]})})]}),e.jsx("div",{className:"mt-4 p-3 rounded-3 bg-info bg-opacity-10",children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{"data-feather":"info",className:"text-info me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("small",{className:"fw-semibold text-info",children:"Conseils pour un mot de passe sécurisé :"}),e.jsxs("ul",{className:`small mb-0 mt-1 ${s==="dark"?"text-light":"text-muted"}`,children:[e.jsx("li",{children:"Au moins 8 caractères"}),e.jsx("li",{children:"Majuscules et minuscules"}),e.jsx("li",{children:"Au moins un chiffre"}),e.jsx("li",{children:"Différent de vos anciens mots de passe"})]})]})]})}),e.jsx(w,{type:"submit",variant:"success",disabled:y||!n.password||!n.password_confirmation,className:"w-100 py-3 fw-semibold text-white border-0 mt-4 position-relative",style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",boxShadow:"0 4px 15px rgba(40, 167, 69, 0.3)"},children:y?e.jsxs(e.Fragment,{children:[e.jsx(J,{animation:"border",size:"sm",className:"me-2"}),"Réinitialisation..."]}):e.jsx(e.Fragment,{children:"Confirmer le nouveau mot de passe"})})]}),m&&e.jsx("div",{className:"text-center mt-4",children:e.jsxs(P,{to:"/forgot-password",className:"btn btn-outline-warning w-100 py-3 fw-semibold",children:[e.jsx("i",{"data-feather":"refresh-cw",className:"me-2",style:{width:"18px",height:"18px"}}),"Demander un nouveau lien"]})}),e.jsxs("div",{className:"text-center my-4",children:[e.jsx("hr",{className:s==="dark"?"border-secondary":""}),e.jsx("span",{className:`px-3 small ${s==="dark"?"bg-dark text-light":"bg-white text-muted"}`,children:"Vous vous souvenez de votre mot de passe ?"})]}),e.jsx("div",{className:"text-center",children:e.jsxs(P,{to:"/login",className:"btn btn-outline-primary w-100 py-3 fw-semibold",children:[e.jsx("i",{"data-feather":"arrow-left",className:"me-2",style:{width:"18px",height:"18px"}}),"Retour à la connexion"]})})]}),e.jsx(b.Footer,{className:`text-center py-3 border-0 ${s==="dark"?"bg-dark":"bg-light"}`,children:e.jsxs(j,{className:"g-2",children:[e.jsx(d,{children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{"data-feather":"shield-check",className:"text-success me-2",style:{width:"16px",height:"16px"}}),e.jsx("small",{className:`fw-semibold ${s==="dark"?"text-light":"text-muted"}`,children:"Réinitialisation sécurisée"})]})}),e.jsx(d,{children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{"data-feather":"clock",className:"text-info me-2",style:{width:"16px",height:"16px"}}),e.jsx("small",{className:`fw-semibold ${s==="dark"?"text-light":"text-muted"}`,children:"Lien à usage unique"})]})})]})})]}),e.jsx("div",{className:`text-center mt-4 ${s==="dark"?"text-light":"text-muted"}`,children:e.jsxs("small",{children:[e.jsx("i",{"data-feather":"info",className:"me-1",style:{width:"12px",height:"12px"}}),"Une fois votre mot de passe réinitialisé, ce lien ne sera plus valide."]})}),e.jsxs(j,{className:"mt-4 g-3",children:[e.jsx(d,{md:4,children:e.jsxs("div",{className:"text-center p-3 rounded-3 h-100 bg-success bg-opacity-10",children:[e.jsx("i",{"data-feather":"key",className:"text-success mb-2",style:{width:"32px",height:"32px"}}),e.jsx("div",{className:"small fw-semibold text-success mb-1",children:"Nouveau mot de passe"}),e.jsx("div",{className:`small ${s==="dark"?"text-light":"text-muted"}`,children:"Choisissez un mot de passe fort"})]})}),e.jsx(d,{md:4,children:e.jsxs("div",{className:"text-center p-3 rounded-3 h-100 bg-warning bg-opacity-10",children:[e.jsx("i",{"data-feather":"clock",className:"text-warning mb-2",style:{width:"32px",height:"32px"}}),e.jsx("div",{className:"small fw-semibold text-warning mb-1",children:"Lien temporaire"}),e.jsx("div",{className:`small ${s==="dark"?"text-light":"text-muted"}`,children:"Valide une seule fois"})]})}),e.jsx(d,{md:4,children:e.jsxs("div",{className:"text-center p-3 rounded-3 h-100 bg-info bg-opacity-10",children:[e.jsx("i",{"data-feather":"shield",className:"text-info mb-2",style:{width:"32px",height:"32px"}}),e.jsx("div",{className:"small fw-semibold text-info mb-1",children:"Sécurité renforcée"}),e.jsx("div",{className:`small ${s==="dark"?"text-light":"text-muted"}`,children:"Processus chiffré"})]})})]})]})})})})};export{ae as default};
