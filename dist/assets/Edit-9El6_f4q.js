import{d as T,u as R,r as l,f as _,j as e,L as h,a as C}from"./index-K0TI1Cn5.js";import{A as v}from"./Layout-MqCQlSlI.js";import{S as B}from"./Spinner-Br6_VxcD.js";import{A as D}from"./Alert-JqR1u8An.js";import{B as m,R as y,C as x,a}from"./Row-DpO6zsT4.js";import{F as t}from"./Form-CAmGkuOD.js";import"./NavBar-BemxVd0Z.js";import"./ElementChildren-DHcghUFE.js";function O(){const{id:n}=T(),$=R(),[r,L]=l.useState(null),[F,w]=l.useState(!0),[u,k]=l.useState(!1),[j,f]=l.useState(null),[c,g]=l.useState({}),[i,S]=l.useState("light"),[p,E]=l.useState({title:"",description:"",status:"active"});l.useEffect(()=>{const o=document.documentElement.getAttribute("data-theme")||"light";S(o);const s=new MutationObserver(()=>{const d=document.documentElement.getAttribute("data-theme")||"light";S(d)});return s.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>s.disconnect()},[]),l.useEffect(()=>{n&&(async()=>{try{w(!0);const d=(await C.get(`/tasks/projects/${n}/`)).data;L(d),E({title:d.title||"",description:d.description||"",status:d.status||"active"})}catch(s){f("Erreur lors du chargement des donn√©es"),console.error("Erreur:",s)}finally{w(!1)}})()},[n]),l.useEffect(()=>{_.replace()},[r]);const b=o=>{const{name:s,value:d}=o.target;E(N=>({...N,[s]:d})),c[s]&&g(N=>({...N,[s]:null}))},A=async o=>{o.preventDefault();try{k(!0),f(null),g({}),(await C.put(`/tasks/projects/${n}/`,p)).data&&$(`/admin/projects/${n}`)}catch(s){s.response?.data?.errors?g(s.response.data.errors):f(s.response?.data?.message||"Erreur lors de la mise √† jour")}finally{k(!1)}};return F?e.jsx(v,{children:e.jsxs("div",{className:"text-center py-5",children:[e.jsx(B,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Chargement des donn√©es..."})]})}):j&&!r?e.jsxs(v,{children:[e.jsxs(D,{variant:"danger",className:"mb-4",children:[e.jsx("i",{"data-feather":"alert-circle",className:"me-2"}),j]}),e.jsx("div",{className:"d-flex gap-2",children:e.jsxs(m,{variant:"secondary",as:h,to:"/admin/projects",children:[e.jsx("i",{"data-feather":"arrow-left",className:"me-2"}),"Retour √† la liste"]})})]}):e.jsxs(v,{children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center mb-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsxs(m,{variant:"outline-secondary",size:"sm",as:h,to:`/admin/projects/${n}`,className:"me-3",children:[e.jsx("i",{"data-feather":"arrow-left",className:"me-1",style:{width:"16px",height:"16px"}}),"Retour"]}),e.jsx("h1",{className:"h3 mb-0",children:"Modifier le projet"})]}),e.jsxs("p",{className:"text-muted mb-0",children:["Modification du projet : ",r?.title]})]})}),j&&e.jsxs(D,{variant:"danger",className:"mb-4",children:[e.jsx("i",{"data-feather":"alert-circle",className:"me-2"}),j]}),e.jsx(t,{onSubmit:A,children:e.jsxs(y,{children:[e.jsx(x,{lg:8,className:"mb-4",children:e.jsxs(a,{className:`border-0 shadow-sm ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"edit",className:"me-2",style:{width:"20px",height:"20px"}}),"Informations du projet"]})}),e.jsxs(a.Body,{children:[e.jsxs(y,{children:[e.jsx(x,{md:12,className:"mb-3",children:e.jsxs(t.Group,{children:[e.jsxs(t.Label,{children:[e.jsx("i",{"data-feather":"type",className:"me-2",style:{width:"16px",height:"16px"}}),"Titre du projet *"]}),e.jsx(t.Control,{type:"text",name:"title",value:p.title,onChange:b,placeholder:"Titre du projet",isInvalid:!!c.title,className:i==="dark"?"bg-dark text-light border-secondary":"",required:!0}),e.jsx(t.Control.Feedback,{type:"invalid",children:c.title?.[0]})]})}),e.jsx(x,{md:12,className:"mb-3",children:e.jsxs(t.Group,{children:[e.jsxs(t.Label,{children:[e.jsx("i",{"data-feather":"file-text",className:"me-2",style:{width:"16px",height:"16px"}}),"Description"]}),e.jsx(t.Control,{as:"textarea",rows:4,name:"description",value:p.description,onChange:b,placeholder:"Description d√©taill√©e du projet...",isInvalid:!!c.description,className:i==="dark"?"bg-dark text-light border-secondary":""}),e.jsx(t.Control.Feedback,{type:"invalid",children:c.description?.[0]})]})}),e.jsx(x,{md:6,className:"mb-3",children:e.jsxs(t.Group,{children:[e.jsxs(t.Label,{children:[e.jsx("i",{"data-feather":"activity",className:"me-2",style:{width:"16px",height:"16px"}}),"Statut"]}),e.jsxs(t.Select,{name:"status",value:p.status,onChange:b,isInvalid:!!c.status,className:i==="dark"?"bg-dark text-light border-secondary":"",children:[e.jsx("option",{value:"active",children:"üü¢ Actif"}),e.jsx("option",{value:"on_hold",children:"üü° En pause"}),e.jsx("option",{value:"completed",children:"üîµ Termin√©"}),e.jsx("option",{value:"archived",children:"‚ö´ Archiv√©"})]}),e.jsx(t.Control.Feedback,{type:"invalid",children:c.status?.[0]})]})})]}),e.jsx("hr",{className:"my-4"}),e.jsx(y,{children:e.jsx(x,{md:12,children:e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx(m,{variant:"outline-secondary",as:h,to:`/admin/projects/${n}`,className:"me-2",disabled:u,children:"Annuler"}),e.jsx(m,{variant:"primary",type:"submit",disabled:u,className:"d-flex align-items-center",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Mise √† jour..."]}):e.jsx(e.Fragment,{children:"Enregistrer les Modifications"})})]})})})]})]})}),e.jsxs(x,{lg:4,children:[r&&e.jsxs(a,{className:`border-0 shadow-sm mb-4 ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:`border-0 ${i==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"info",className:"me-2 text-success",style:{width:"20px",height:"20px"}}),"Informations actuelles"]})}),e.jsxs(a.Body,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("span",{className:"small",children:"T√¢ches totales"}),e.jsx("span",{className:"small fw-bold",children:r.tasks_count||0})]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("span",{className:"small",children:"T√¢ches termin√©es"}),e.jsx("span",{className:"small text-success",children:r.completed_tasks_count||0})]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("span",{className:"small",children:"Cr√©√© le"}),e.jsx("span",{className:"small",children:new Date(r.created_at).toLocaleDateString("fr-FR")})]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("span",{className:"small",children:"Derni√®re modification"}),e.jsx("span",{className:"small",children:new Date(r.updated_at).toLocaleDateString("fr-FR")})]}),r.completed_at&&e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("span",{className:"small",children:"Termin√© le"}),e.jsx("span",{className:"small",children:new Date(r.completed_at).toLocaleDateString("fr-FR")})]})]})]}),e.jsxs(a,{className:`border-0 shadow-sm mb-4 ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:`border-0 ${i==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"help-circle",className:"me-2 text-info",style:{width:"20px",height:"20px"}}),"Conseils"]})}),e.jsx(a.Body,{children:e.jsxs("div",{className:"small",children:[e.jsxs("div",{className:"d-flex align-items-start mb-2",children:[e.jsx("i",{"data-feather":"folder",className:"text-primary me-2 mt-1",style:{width:"14px",height:"14px"}}),e.jsx("span",{children:"Un titre clair aide √† identifier rapidement le projet"})]}),e.jsxs("div",{className:"d-flex align-items-start mb-2",children:[e.jsx("i",{"data-feather":"file-text",className:"text-primary me-2 mt-1",style:{width:"14px",height:"14px"}}),e.jsx("span",{children:"La description doit expliquer les objectifs du projet"})]}),e.jsxs("div",{className:"d-flex align-items-start mb-2",children:[e.jsx("i",{"data-feather":"activity",className:"text-primary me-2 mt-1",style:{width:"14px",height:"14px"}}),e.jsx("span",{children:"Mettez √† jour le statut selon l'avancement du projet"})]}),e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{"data-feather":"users",className:"text-primary me-2 mt-1",style:{width:"14px",height:"14px"}}),e.jsx("span",{children:"Les projets peuvent contenir des t√¢ches de plusieurs utilisateurs"})]})]})})]}),e.jsxs(a,{className:`border-0 shadow-sm ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:`border-0 ${i==="dark"?"bg-dark":"bg-white"}`,children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"settings",className:"me-2 text-warning",style:{width:"20px",height:"20px"}}),"Actions suppl√©mentaires"]})}),e.jsx(a.Body,{children:e.jsxs("div",{className:"d-grid gap-2",children:[e.jsxs(m,{variant:"outline-info",as:h,to:`/admin/projects/${n}`,children:[e.jsx("i",{"data-feather":"eye",className:"me-2",style:{width:"16px",height:"16px"}}),"Voir le projet"]}),e.jsxs(m,{variant:"outline-primary",as:h,to:`/admin/projects/${n}/tasks`,children:[e.jsx("i",{"data-feather":"list",className:"me-2",style:{width:"16px",height:"16px"}}),"Voir les t√¢ches"]}),e.jsxs(m,{variant:"outline-secondary",as:h,to:"/admin/projects",children:[e.jsx("i",{"data-feather":"folder",className:"me-2",style:{width:"16px",height:"16px"}}),"Tous les projets"]})]})})]})]})]})})]})}export{O as default};
