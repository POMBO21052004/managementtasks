import{d as F,r as o,f as I,j as e,L as h,a as y}from"./index-hRRtG8yy.js";import{A as v}from"./Layout-Js2Zl1pA.js";import{S as P}from"./Spinner-CLl_Ort6.js";import{A as O}from"./Alert-CoKbwLKe.js";import{B as x,R as N,C as d,a}from"./Row-bX7h-1jy.js";import{B as c}from"./NavBar-mvMqGCSV.js";import{P as S}from"./ProgressBar-Dqb3uvNn.js";import{T as G}from"./Table-qWWWCHOI.js";import"./ElementChildren-NDIL728O.js";function te(){const{id:m}=F(),[r,B]=o.useState(null),[n,E]=o.useState([]),[t,R]=o.useState(null),[A,w]=o.useState(!0),[C,D]=o.useState(!0),[k,M]=o.useState(null),[i,_]=o.useState("light");o.useEffect(()=>{const s=document.documentElement.getAttribute("data-theme")||"light";_(s);const l=new MutationObserver(()=>{const f=document.documentElement.getAttribute("data-theme")||"light";_(f)});return l.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>l.disconnect()},[]),o.useEffect(()=>{m&&(async()=>{try{w(!0);const l=await y.get(`/tasks/projects/${m}/`);B(l.data);try{const b=await y.get(`/tasks/projects/${m}/statistics/`);R(b.data)}catch(b){console.error("Erreur lors du chargement des statistiques:",b)}const f=await y.get(`/tasks/projects/${m}/my_tasks/`);E(f.data||[])}catch(l){M("Erreur lors du chargement du projet"),console.error("Erreur:",l)}finally{w(!1),D(!1)}})()},[m]),o.useEffect(()=>{I.replace()},[r,n,t]);const T=s=>({active:"success",completed:"primary",archived:"secondary",on_hold:"warning"})[s]||"secondary",$=s=>({active:"Actif",completed:"TerminÃ©",archived:"ArchivÃ©",on_hold:"En pause"})[s]||s,H=s=>({high:"danger",medium:"warning",low:"success"})[s]||"secondary",L=s=>({high:"Haute",medium:"Moyenne",low:"Basse"})[s]||s,z=s=>({done:"success",in_progress:"primary",todo:"secondary"})[s]||"secondary",V=s=>({done:"TerminÃ©e",in_progress:"En cours",todo:"Ã€ faire"})[s]||s,j=s=>s?new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"Non dÃ©finie",q=()=>{if(!n.length)return 0;const s=n.filter(l=>l.status==="done").length;return Math.round(s/n.length*100)},U=()=>!t||!t.total_tasks?0:Math.round(t.completed_tasks/t.total_tasks*100),p=s=>s>=80?"success":s>=50?"warning":"danger";if(A)return e.jsx(v,{children:e.jsxs("div",{className:"text-center py-5",children:[e.jsx(P,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Chargement des informations du projet..."})]})});if(k||!r)return e.jsxs(v,{children:[e.jsxs(O,{variant:"danger",className:"mb-4",children:[e.jsx("i",{"data-feather":"alert-circle",className:"me-2"}),k||"Projet introuvable"]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(x,{variant:"secondary",as:h,to:"/employee/projects",children:[e.jsx("i",{"data-feather":"arrow-left",className:"me-2"}),"Retour aux projets"]}),e.jsxs(x,{variant:"primary",as:h,to:"/employe/dashboard",children:[e.jsx("i",{"data-feather":"home",className:"me-2"}),"Dashboard"]})]})]});const u=q(),g=U();return e.jsxs(v,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsxs(x,{variant:"outline-secondary",size:"sm",as:h,to:"/employee/projects",className:"me-3",children:[e.jsx("i",{"data-feather":"arrow-left",className:"me-1",style:{width:"16px",height:"16px"}}),"Mes Projets"]}),e.jsxs("div",{children:[e.jsx("h1",{className:`h3 mb-0 ${i==="dark"?"text-light":"text-dark"}`,children:r.title}),e.jsxs("div",{className:"d-flex align-items-center gap-2 mt-1",children:[e.jsx(c,{bg:T(r.status),className:"px-2 py-1",children:$(r.status)}),e.jsxs(c,{bg:"info",className:"px-2 py-1",children:[n.length," tÃ¢che(s) assignÃ©e(s)"]})]})]})]}),r.description&&e.jsx("p",{className:`mb-0 ${i==="dark"?"text-light":"text-muted"}`,children:r.description})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(x,{variant:"primary",as:h,to:`/employee/projects/${m}/tasks`,className:"d-flex align-items-center",children:[e.jsx("i",{"data-feather":"list",className:"me-2",style:{width:"16px",height:"16px"}}),"Voir toutes mes tÃ¢ches"]}),e.jsxs(x,{variant:"outline-primary",as:h,to:"/employee/tasks/create",state:{project_id:m},className:"d-flex align-items-center",children:[e.jsx("i",{"data-feather":"plus",className:"me-2",style:{width:"16px",height:"16px"}}),"Nouvelle tÃ¢che"]})]})]}),e.jsxs(N,{children:[e.jsxs(d,{lg:8,children:[e.jsxs(N,{className:"mb-4",children:[e.jsx(d,{md:6,children:e.jsxs(a,{className:`border-0 shadow-sm h-100 ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:"border-0",children:e.jsxs("h6",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"user",className:"me-2 text-primary",style:{width:"16px",height:"16px"}}),"Ma Progression"]})}),e.jsx(a.Body,{children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`display-4 fw-bold mb-2 text-${p(u)}`,children:[u,"%"]}),e.jsx("div",{className:"mb-3",children:e.jsx(S,{now:u,variant:p(u),style:{height:"8px"}})}),e.jsxs("div",{className:"small text-muted",children:[n.filter(s=>s.status==="done").length," sur ",n.length," tÃ¢ches terminÃ©es"]})]})})]})}),e.jsx(d,{md:6,children:e.jsxs(a,{className:`border-0 shadow-sm h-100 ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:"border-0",children:e.jsxs("h6",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"users",className:"me-2 text-info",style:{width:"16px",height:"16px"}}),"Progression Globale"]})}),e.jsx(a.Body,{children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`display-4 fw-bold mb-2 text-${p(g)}`,children:[g,"%"]}),e.jsx("div",{className:"mb-3",children:e.jsx(S,{now:g,variant:p(g),style:{height:"8px"}})}),e.jsxs("div",{className:"small text-muted",children:[t?.completed_tasks||0," sur ",t?.total_tasks||0," tÃ¢ches terminÃ©es"]})]})})]})})]}),e.jsxs(a,{className:`border-0 shadow-sm mb-4 ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"file-text",className:"me-2",style:{width:"20px",height:"20px"}}),"DÃ©tails du projet"]})}),e.jsxs(a.Body,{children:[e.jsx(N,{className:"mb-4",children:e.jsxs(d,{md:12,children:[e.jsx("h4",{className:"mb-3",children:r.title}),r.description?e.jsx("div",{className:`p-3 rounded ${i==="dark"?"bg-dark border":"bg-light"}`,children:e.jsx("p",{className:"mb-0",style:{whiteSpace:"pre-wrap"},children:r.description})}):e.jsx("p",{className:"text-muted fst-italic",children:"Aucune description fournie"})]})}),e.jsx("hr",{className:"my-4"}),e.jsxs(N,{children:[e.jsx(d,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Statut :"}),e.jsx(c,{bg:T(r.status),children:$(r.status)})]})}),e.jsx(d,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"TÃ¢ches totales :"}),e.jsx("span",{className:"fw-medium",children:t?.total_tasks||0})]})}),e.jsx(d,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Mes tÃ¢ches :"}),e.jsx("span",{className:"fw-medium text-primary",children:n.length})]})}),e.jsx(d,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"TÃ¢ches terminÃ©es :"}),e.jsx("span",{className:"fw-medium text-success",children:t?.completed_tasks||0})]})}),e.jsx(d,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"CrÃ©Ã© le :"}),e.jsx("span",{className:"fw-medium",children:j(r.created_at)})]})}),e.jsx(d,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"DerniÃ¨re modification :"}),e.jsx("span",{className:"fw-medium",children:j(r.updated_at)})]})}),r.completed_at&&e.jsx(d,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"TerminÃ© le :"}),e.jsx("span",{className:"fw-medium text-success",children:j(r.completed_at)})]})})]})]})]}),e.jsxs(a,{className:`border-0 shadow-sm ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:"border-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"list",className:"me-2",style:{width:"20px",height:"20px"}}),"Mes TÃ¢ches dans ce Projet"]}),e.jsx(c,{bg:"primary",children:n.length})]})}),e.jsx(a.Body,{children:C?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(P,{animation:"border",size:"sm"}),e.jsx("p",{className:"mt-2",children:"Chargement des tÃ¢ches..."})]}):n.length>0?e.jsxs("div",{className:"table-responsive",children:[e.jsxs(G,{hover:!0,className:`align-middle ${i==="dark"?"table-dark":""}`,children:[e.jsx("thead",{className:"table-primary",children:e.jsxs("tr",{children:[e.jsx("th",{children:"TÃ¢che"}),e.jsx("th",{className:"text-center",children:"PrioritÃ©"}),e.jsx("th",{className:"text-center",children:"Statut"}),e.jsx("th",{className:"text-center",children:"Ã‰chÃ©ance"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:n.slice(0,5).map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("div",{className:`fw-bold ${i==="dark"?"text-light":"text-dark"}`,children:s.title}),s.description&&e.jsx("small",{className:i==="dark"?"text-light":"text-muted",children:s.description.length>80?`${s.description.substring(0,80)}...`:s.description})]})}),e.jsx("td",{className:"text-center",children:e.jsx(c,{bg:H(s.priority),children:L(s.priority)})}),e.jsx("td",{className:"text-center",children:e.jsx(c,{bg:z(s.status),children:V(s.status)})}),e.jsx("td",{className:"text-center",children:e.jsx("small",{className:i==="dark"?"text-light":"text-muted",children:j(s.due_date)})}),e.jsx("td",{className:"text-center",children:e.jsx(x,{size:"sm",variant:"outline-info",as:h,to:`/employee/tasks/${s.id}`,title:"Voir les dÃ©tails",children:e.jsx("i",{"data-feather":"eye",style:{width:"14px",height:"14px"}})})})]},s.id))})]}),n.length>5&&e.jsx("div",{className:"text-center mt-3",children:e.jsxs(x,{variant:"outline-primary",as:h,to:`/employee/projects/${m}/tasks`,size:"sm",children:["Voir toutes mes ",n.length," tÃ¢ches",e.jsx("i",{"data-feather":"arrow-right",className:"ms-1",style:{width:"14px",height:"14px"}})]})})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("i",{"data-feather":"check-square",className:"mb-3",style:{width:"48px",height:"48px",opacity:.5}}),e.jsx("h6",{className:i==="dark"?"text-light":"text-dark",children:"Aucune tÃ¢che assignÃ©e"}),e.jsx("p",{className:i==="dark"?"text-light":"text-muted",children:"Vous n'avez pas de tÃ¢ches dans ce projet pour le moment."}),e.jsxs(x,{variant:"primary",as:h,to:"/employee/tasks/create",state:{project_id:m},children:[e.jsx("i",{"data-feather":"plus",className:"me-2",style:{width:"16px",height:"16px"}}),"CrÃ©er une tÃ¢che"]})]})})]})]}),e.jsxs(d,{lg:4,children:[t&&e.jsxs(a,{className:`border-0 shadow-sm mb-4 ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"bar-chart",className:"me-2 text-info",style:{width:"20px",height:"20px"}}),"Statistiques du Projet"]})}),e.jsx(a.Body,{children:e.jsxs("div",{className:"small",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("span",{children:"Total des tÃ¢ches"}),e.jsx(c,{bg:"primary",children:t.total_tasks})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("span",{children:"TÃ¢ches terminÃ©es"}),e.jsx(c,{bg:"success",children:t.completed_tasks})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("span",{children:"TÃ¢ches en cours"}),e.jsx(c,{bg:"warning",children:t.pending_tasks})]}),e.jsx("hr",{className:"my-2"}),e.jsx("h6",{className:"mb-2",children:"Par prioritÃ©"}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsx("span",{className:"small",children:"ðŸ”´ Haute"}),e.jsx(c,{bg:"danger",children:t.by_priority?.high||0})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsx("span",{className:"small",children:"ðŸŸ¡ Moyenne"}),e.jsx(c,{bg:"warning",children:t.by_priority?.medium||0})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("span",{className:"small",children:"ðŸŸ¢ Basse"}),e.jsx(c,{bg:"success",children:t.by_priority?.low||0})]}),e.jsx("hr",{className:"my-2"}),e.jsx("h6",{className:"mb-2",children:"Par statut"}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsx("span",{className:"small",children:"â³ Ã€ faire"}),e.jsx(c,{bg:"secondary",children:t.by_status?.todo||0})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsx("span",{className:"small",children:"ðŸ”„ En cours"}),e.jsx(c,{bg:"primary",children:t.by_status?.in_progress||0})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("span",{className:"small",children:"âœ… TerminÃ©e"}),e.jsx(c,{bg:"success",children:t.by_status?.done||0})]})]})})]}),e.jsxs(a,{className:`border-0 shadow-sm mb-4 ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"zap",className:"me-2 text-warning",style:{width:"20px",height:"20px"}}),"Actions Rapides"]})}),e.jsx(a.Body,{children:e.jsxs("div",{className:"d-grid gap-2",children:[e.jsxs(x,{variant:"primary",as:h,to:`/employee/projects/${m}/tasks`,children:[e.jsx("i",{"data-feather":"list",className:"me-2",style:{width:"16px",height:"16px"}}),"Toutes mes tÃ¢ches"]}),e.jsxs(x,{variant:"success",as:h,to:"/employee/tasks/create",state:{project_id:m},children:[e.jsx("i",{"data-feather":"plus",className:"me-2",style:{width:"16px",height:"16px"}}),"Nouvelle tÃ¢che"]}),e.jsxs(x,{variant:"outline-secondary",as:h,to:"/employee/projects",children:[e.jsx("i",{"data-feather":"folder",className:"me-2",style:{width:"16px",height:"16px"}}),"Mes projets"]})]})})]}),e.jsxs(a,{className:`border-0 shadow-sm ${i==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(a.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"info",className:"me-2 text-secondary",style:{width:"20px",height:"20px"}}),"Informations"]})}),e.jsx(a.Body,{children:e.jsxs("div",{className:"small",children:[e.jsxs("div",{className:"d-flex align-items-start mb-3",children:[e.jsx("i",{"data-feather":"hash",className:"text-secondary me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:"ID Projet"}),e.jsx("div",{className:"text-muted",children:r.id})]})]}),e.jsxs("div",{className:"d-flex align-items-start mb-3",children:[e.jsx("i",{"data-feather":"calendar",className:"text-secondary me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:"Date de crÃ©ation"}),e.jsx("div",{className:"text-muted",children:j(r.created_at)})]})]}),e.jsxs("div",{className:"d-flex align-items-start mb-3",children:[e.jsx("i",{"data-feather":"clock",className:"text-secondary me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:"DerniÃ¨re modification"}),e.jsx("div",{className:"text-muted",children:j(r.updated_at)})]})]}),t?.users_stats&&t.users_stats.length>0&&e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{"data-feather":"users",className:"text-secondary me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:"Utilisateurs"}),e.jsxs("div",{className:"text-muted",children:[t.users_stats.length," participant(s)"]})]})]})]})})]})]})]})]})}export{te as default};
