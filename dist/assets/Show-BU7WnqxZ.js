import{d as I,u as L,r as d,f as P,j as e,L as u,a as o}from"./index-K0TI1Cn5.js";import{A as g}from"./Layout-MqCQlSlI.js";import{S as O}from"./Spinner-Br6_VxcD.js";import{A as F}from"./Alert-JqR1u8An.js";import{B as c,R as v,C as i,a as t}from"./Row-DpO6zsT4.js";import{B as m}from"./NavBar-BemxVd0Z.js";import{M as j}from"./Modal-D-5iwAgh.js";import{T as V,a as b}from"./ToastContainer-Zqrc0L-G.js";function Y(){const{id:l}=I(),S=L(),[s,p]=d.useState(null),[T,y]=d.useState(!0),[w,E]=d.useState(null),[r,_]=d.useState("light"),[U,k]=d.useState(!1),[$,D]=d.useState(""),[N,B]=d.useState("success"),[M,f]=d.useState(!1);d.useEffect(()=>{const a=document.documentElement.getAttribute("data-theme")||"light";_(a);const n=new MutationObserver(()=>{const R=document.documentElement.getAttribute("data-theme")||"light";_(R)});return n.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>n.disconnect()},[]);const x=(a,n="success")=>{D(a),B(n),k(!0)};d.useEffect(()=>{l&&(async()=>{try{y(!0);const n=await o.get(`/auth/admin/users/${l}/`);p(n.data)}catch(n){E("Erreur lors du chargement de l'utilisateur"),console.error("Erreur:",n)}finally{y(!1)}})()},[l]),d.useEffect(()=>{P.replace()},[s]);const H=async()=>{try{await o.delete(`/auth/admin/users/${l}/`),x("Utilisateur supprimé avec succès","success"),setTimeout(()=>{S("/admin/users")},1500)}catch(a){console.error(a),x(a.response?.data?.error||"Erreur lors de la suppression","danger")}f(!1)},A=async()=>{try{await o.post(`/auth/admin/users/${l}/toggle_admin/`);const a=await o.get(`/auth/admin/users/${l}/`);p(a.data),x(a.data.is_admin?"Utilisateur promu administrateur":"Utilisateur rétrogradé","success")}catch(a){console.error(a),x(a.response?.data?.error||"Erreur lors de la modification","danger")}},C=async()=>{try{await o.post(`/auth/admin/users/${l}/toggle_verified/`);const a=await o.get(`/auth/admin/users/${l}/`);p(a.data),x(a.data.is_verified?"Utilisateur vérifié":"Utilisateur non vérifié","success")}catch(a){console.error(a),x("Erreur lors de la modification","danger")}},h=a=>a?new Date(a).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Non renseigné";return T?e.jsx(g,{children:e.jsxs("div",{className:"text-center py-5",children:[e.jsx(O,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Chargement des informations de l'utilisateur..."})]})}):w||!s?e.jsxs(g,{children:[e.jsxs(F,{variant:"danger",className:"mb-4",children:[e.jsx("i",{"data-feather":"alert-circle",className:"me-2"}),w||"Utilisateur introuvable"]}),e.jsx("div",{className:"d-flex gap-2",children:e.jsxs(c,{variant:"secondary",as:u,to:"/admin/users",children:[e.jsx("i",{"data-feather":"arrow-left",className:"me-2"}),"Retour à la liste"]})})]}):e.jsxs(g,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsxs(c,{variant:"outline-secondary",size:"sm",as:u,to:"/admin/users",className:"me-3",children:[e.jsx("i",{"data-feather":"arrow-left",className:"me-1",style:{width:"16px",height:"16px"}}),"Retour"]}),e.jsxs("div",{children:[e.jsx("h1",{className:`h3 mb-0 ${r==="dark"?"text-light":"text-dark"}`,children:s.username}),e.jsxs("div",{className:"d-flex align-items-center gap-2 mt-1",children:[e.jsxs("small",{className:"text-muted",children:["ID: ",s.id]}),e.jsxs(m,{bg:s.is_admin?"success":"info",className:"px-2 py-1",children:[e.jsx("i",{"data-feather":s.is_admin?"shield":"user",className:"me-1",style:{width:"12px",height:"12px"}}),s.is_admin?"Administrateur":"Utilisateur"]})]})]})]})}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(c,{variant:"primary",as:u,to:`/admin/users/${l}/edit`,children:[e.jsx("i",{"data-feather":"edit",className:"me-2",style:{width:"16px",height:"16px"}}),"Modifier"]}),e.jsxs(c,{variant:"danger",onClick:()=>f(!0),children:[e.jsx("i",{"data-feather":"trash-2",className:"me-2",style:{width:"16px",height:"16px"}}),"Supprimer"]})]})]}),e.jsxs(v,{children:[e.jsxs(i,{lg:8,children:[e.jsxs(t,{className:`border-0 shadow-sm mb-4 ${r==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(t.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"user",className:"me-2",style:{width:"20px",height:"20px"}}),"Profil de l'utilisateur"]})}),e.jsxs(t.Body,{children:[e.jsxs(v,{className:"align-items-center mb-4",children:[e.jsx(i,{md:3,className:"text-center",children:e.jsxs("div",{className:"position-relative d-inline-block",children:[e.jsx("div",{className:"rounded-circle bg-primary bg-opacity-10 d-flex align-items-center justify-content-center border",style:{width:"120px",height:"120px"},children:e.jsx("i",{"data-feather":"user",className:"text-primary",style:{width:"48px",height:"48px"}})}),e.jsx(m,{bg:s.is_admin?"success":"info",className:"position-absolute bottom-0 end-0 rounded-circle p-2",style:{transform:"translate(25%, 25%)"},children:e.jsx("i",{"data-feather":s.is_admin?"shield":"user",style:{width:"12px",height:"12px"}})})]})}),e.jsxs(i,{md:9,children:[e.jsx("h4",{className:"mb-2",children:s.username}),s.first_name&&s.last_name&&e.jsxs("p",{className:"text-muted mb-2",children:[e.jsx("i",{"data-feather":"user-check",className:"me-2",style:{width:"16px",height:"16px"}}),s.first_name," ",s.last_name]}),e.jsxs("p",{className:"text-muted mb-2",children:[e.jsx("i",{"data-feather":"mail",className:"me-2",style:{width:"16px",height:"16px"}}),s.email]}),s.phone&&e.jsxs("p",{className:"text-muted mb-2",children:[e.jsx("i",{"data-feather":"phone",className:"me-2",style:{width:"16px",height:"16px"}}),s.phone]}),e.jsxs("div",{className:"d-flex align-items-center flex-wrap gap-2",children:[e.jsxs(m,{bg:s.is_admin?"success":"secondary",className:"cursor-pointer",onClick:A,title:"Cliquer pour changer le statut admin",children:[e.jsx("i",{"data-feather":s.is_admin?"shield":"user",className:"me-1",style:{width:"12px",height:"12px"}}),s.is_admin?"Administrateur":"Utilisateur"]}),e.jsxs(m,{bg:s.is_verified?"warning":"secondary",className:"cursor-pointer",onClick:C,title:"Cliquer pour changer le statut vérifié",children:[e.jsx("i",{"data-feather":s.is_verified?"check-circle":"x-circle",className:"me-1",style:{width:"12px",height:"12px"}}),s.is_verified?"Vérifié":"Non vérifié"]})]})]})]}),e.jsx("hr",{className:"my-4"}),e.jsxs(v,{children:[e.jsx(i,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Nom d'utilisateur :"}),e.jsx("span",{className:"fw-medium",children:s.username})]})}),e.jsx(i,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Email :"}),e.jsx("span",{className:"fw-medium",children:s.email})]})}),s.first_name&&e.jsx(i,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Prénom :"}),e.jsx("span",{className:"fw-medium",children:s.first_name})]})}),s.last_name&&e.jsx(i,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Nom :"}),e.jsx("span",{className:"fw-medium",children:s.last_name})]})}),s.phone&&e.jsx(i,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Téléphone :"}),e.jsx("span",{className:"fw-medium",children:s.phone})]})}),e.jsx(i,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Inscrit depuis :"}),e.jsx("span",{className:"fw-medium",children:h(s.date_joined)})]})}),e.jsx(i,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Dernière connexion :"}),e.jsx("span",{className:"fw-medium",children:s.last_login?h(s.last_login):"Jamais connecté"})]})}),e.jsx(i,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Statut admin :"}),e.jsx(m,{bg:s.is_admin?"success":"secondary",children:s.is_admin?"Oui":"Non"})]})}),e.jsx(i,{md:6,className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Compte vérifié :"}),e.jsx(m,{bg:s.is_verified?"success":"secondary",children:s.is_verified?"Oui":"Non"})]})})]})]})]}),e.jsxs(t,{className:`border-0 shadow-sm ${r==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(t.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"activity",className:"me-2",style:{width:"20px",height:"20px"}}),"Activités et permissions"]})}),e.jsx(t.Body,{children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6 mb-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{"data-feather":s.is_admin?"shield":"user",className:"text-primary me-3",style:{width:"18px",height:"18px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold",children:"Niveau d'accès"}),e.jsx("small",{className:"text-muted",children:s.is_admin?"Accès administrateur complet":"Accès utilisateur standard"})]})]})}),e.jsx("div",{className:"col-md-6 mb-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{"data-feather":s.is_verified?"check-circle":"x-circle",className:s.is_verified?"text-success me-3":"text-danger me-3",style:{width:"18px",height:"18px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold",children:"Statut du compte"}),e.jsx("small",{className:"text-muted",children:s.is_verified?"Compte vérifié et actif":"Compte en attente de vérification"})]})]})}),e.jsx("div",{className:"col-md-6 mb-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{"data-feather":"calendar",className:"text-info me-3",style:{width:"18px",height:"18px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold",children:"Ancienneté"}),e.jsxs("small",{className:"text-muted",children:["Membre depuis ",h(s.date_joined)]})]})]})}),e.jsx("div",{className:"col-md-6 mb-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{"data-feather":"clock",className:"text-warning me-3",style:{width:"18px",height:"18px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold",children:"Dernière activité"}),e.jsx("small",{className:"text-muted",children:s.last_login?h(s.last_login):"Aucune activité"})]})]})})]})})]})]}),e.jsxs(i,{lg:4,children:[e.jsxs(t,{className:`border-0 shadow-sm mb-4 ${r==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(t.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"settings",className:"me-2",style:{width:"20px",height:"20px"}}),"Actions rapides"]})}),e.jsx(t.Body,{children:e.jsxs("div",{className:"d-grid gap-2",children:[e.jsxs(c,{variant:"primary",as:u,to:`/admin/users/${l}/edit`,children:[e.jsx("i",{"data-feather":"edit-2",className:"me-2",style:{width:"18px",height:"18px"}}),"Modifier le profil"]}),e.jsxs(c,{variant:s.is_admin?"warning":"success",onClick:A,children:[e.jsx("i",{"data-feather":s.is_admin?"user":"shield",className:"me-2",style:{width:"18px",height:"18px"}}),s.is_admin?"Rétrograder":"Promouvoir Admin"]}),e.jsxs(c,{variant:s.is_verified?"warning":"success",onClick:C,children:[e.jsx("i",{"data-feather":s.is_verified?"x-circle":"check-circle",className:"me-2",style:{width:"18px",height:"18px"}}),s.is_verified?"Désactiver":"Activer Vérification"]}),e.jsxs(c,{variant:"outline-info",as:u,to:"/admin/users",children:[e.jsx("i",{"data-feather":"list",className:"me-2",style:{width:"18px",height:"18px"}}),"Tous les utilisateurs"]})]})})]}),e.jsxs(t,{className:`border-0 shadow-sm mb-4 ${r==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(t.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"bar-chart",className:"me-2",style:{width:"20px",height:"20px"}}),"Statut du compte"]})}),e.jsxs(t.Body,{children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("div",{className:s.is_admin?"text-success mb-2":"text-info mb-2",children:e.jsx("i",{"data-feather":s.is_admin?"shield":"user",style:{width:"32px",height:"32px"}})}),e.jsx("h6",{className:"mb-0",children:"Type de compte"}),e.jsx("h4",{className:s.is_admin?"text-success mb-0":"text-info mb-0",children:s.is_admin?"Administrateur":"Utilisateur"}),e.jsx("small",{className:"text-muted",children:s.is_admin?"Accès complet au système":"Accès utilisateur standard"})]}),e.jsx("hr",{className:"my-3"}),e.jsxs("div",{className:"small",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Profil complété :"}),e.jsx("span",{className:"fw-bold text-success",children:s.username&&s.email?"100%":s.username?"75%":"50%"})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Dernière connexion :"}),e.jsx("span",{children:s.last_login?h(s.last_login):"Jamais"})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Compte vérifié :"}),e.jsx(m,{bg:s.is_verified?"success":"secondary",children:s.is_verified?"Oui":"Non"})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Statut :"}),e.jsx(m,{bg:s.is_active?"success":"danger",children:s.is_active?"Actif":"Inactif"})]})]})]})]}),e.jsxs(t,{className:`border-0 shadow-sm ${r==="dark"?"bg-dark":"bg-white"}`,children:[e.jsx(t.Header,{className:"border-0",children:e.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[e.jsx("i",{"data-feather":"info",className:"me-2 text-secondary",style:{width:"20px",height:"20px"}}),"Informations système"]})}),e.jsx(t.Body,{children:e.jsxs("div",{className:"small",children:[e.jsxs("div",{className:"d-flex align-items-start mb-3",children:[e.jsx("i",{"data-feather":"hash",className:"text-secondary me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:"ID Utilisateur"}),e.jsx("div",{className:"text-muted",children:s.id})]})]}),e.jsxs("div",{className:"d-flex align-items-start mb-3",children:[e.jsx("i",{"data-feather":"calendar",className:"text-secondary me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:"Date de création"}),e.jsx("div",{className:"text-muted",children:h(s.date_joined)})]})]}),e.jsxs("div",{className:"d-flex align-items-start mb-3",children:[e.jsx("i",{"data-feather":"clock",className:"text-secondary me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:"Dernière modification"}),e.jsx("div",{className:"text-muted",children:h(s.updated_at)})]})]}),e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{"data-feather":"shield",className:"text-secondary me-2 mt-1",style:{width:"16px",height:"16px"}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:"Niveau d'accès"}),e.jsx("div",{className:"text-muted",children:s.is_admin?"Administrateur - Accès complet":"Utilisateur - Accès limité"})]})]})]})})]})]})]}),e.jsxs(j,{show:M,onHide:()=>f(!1),centered:!0,contentClassName:r==="dark"?"bg-dark text-light":"",children:[e.jsx(j.Header,{className:r==="dark"?"bg-dark text-light border-secondary":"",closeButton:!0,children:e.jsx(j.Title,{children:"Confirmation de Suppression"})}),e.jsxs(j.Body,{className:r==="dark"?"bg-dark text-light":"",children:[e.jsx("p",{children:"Êtes-vous sûr de vouloir supprimer cet utilisateur ?"}),e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("i",{"data-feather":"alert-triangle",className:"me-2",style:{width:"16px",height:"16px"}}),`Cette action est irréversible. L'utilisateur "`,s.username,'" sera définitivement supprimé du système.']}),s.is_admin&&e.jsxs("div",{className:"alert alert-danger",children:[e.jsx("i",{"data-feather":"alert-octagon",className:"me-2",style:{width:"16px",height:"16px"}}),e.jsx("strong",{children:"Attention :"})," Cet utilisateur est un administrateur. Sa suppression peut affecter le fonctionnement du système."]})]}),e.jsxs(j.Footer,{className:r==="dark"?"bg-dark text-light border-secondary":"",children:[e.jsx(c,{variant:"secondary",onClick:()=>f(!1),children:"Annuler"}),e.jsxs(c,{variant:"danger",onClick:H,children:[e.jsx("i",{"data-feather":"trash-2",className:"me-2",style:{width:"16px",height:"16px"}}),"Supprimer définitivement"]})]})]}),e.jsx(V,{position:"bottom-end",className:"p-3 position-fixed",style:{zIndex:1050},children:e.jsxs(b,{show:U,onClose:()=>k(!1),delay:3e3,autohide:!0,bg:N==="success"?"success":"danger",className:r==="dark"?"text-light":"text-white",children:[e.jsx(b.Header,{closeButton:!1,className:`${N==="success"?"bg-success text-white":"bg-danger text-white"}`,children:e.jsxs("strong",{className:"me-auto",children:[e.jsx("i",{"data-feather":N==="success"?"check-circle":"x-circle",className:"me-2",style:{width:"16px",height:"16px"}}),"Notification"]})}),e.jsx(b.Body,{className:r==="dark"?"bg-dark text-light":"",children:$})]})})]})}export{Y as default};
